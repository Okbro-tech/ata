{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ATA SocialMedia Home</title>
  <title>{{ user.username }}'s Social Media</title>

  <link rel="stylesheet" href="{% static 'css/style.css' %}?v={% now 'YmdHis' %}">
</head>
<body>
  <header class="header">
    <h1 class="logo">ATA SocialMedia</h1>
    <nav class="nav">
      <ul class="nav-bar">
        <li class="profile-container">
          <a href="/profile">Profile</a>
          <div class="profile-dropdown">
            <a href="/logout">Log Out</a>
          </div>
        </li>
        <li><a href="/">Home</a></li>
        <li><a href="/settings">Settings</a></li>
        <li class="upload-container">
          <button id="upload-trigger">Upload</button>
          <div id="upload-options" class="upload-options">
            <form action="/upload/" method="POST" enctype="multipart/form-data" id="upload-form">
              {% csrf_token %}
              <input type="file" id="file-input" name="image_upload" hidden />
              <label id="file-name" class="file-name">No file selected</label>
              <button type="button" id="select-button">Select File</button>
              <button type="button" id="upload-button">Upload</button>
              <input type="text" name="caption" id="caption-input" placeholder="Enter caption..." />
            </form>
          </div>
        </li>
      </ul>
    </nav>
  </header>

  <div class="home-container">
    {% for post in posts %}
    <div class="post">
      <div class="post-header">
        <img class="user-avatar" src="{{ post.user.profile.profileimg.url }}" alt="User Avatar">
        <div class="user-details">
          <h3 class="username"> <a href="{% url 'user_profile' user_id=post.user.id %}">@{{ post.user.username }}</a></h3>
          <p class="post-date">{{ post.created_at|timesince }} ago</p>
        </div>
      </div>

      <div class="post-content">
        <p>{{ post.caption }}</p>
        {% if post.image %}
          <img class="post-image" src="{{ post.image.url }}" alt="Post Content">
        {% endif %}
        {% if post.video %}
          <video class="post-video" controls>
            <source src="{{ post.video.url }}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        {% endif %}
      </div>

      <div class="post-actions">
        <button class="like-btn">Like (<span class="like-count">{{ post.no_of_likes }}</span>)</button>
        <button class="comment-btn">Comment</button>
        <button class="repost-btn">Repost</button>
      </div>

      <div class="comments-section">
        {% for comment in post.comments.all %}
        <div class="comment">
          <img class="comment-avatar" src="{{ comment.user.profile.profileimg.url }}" alt="Comment Avatar">
          <p class="comment-text"><strong>{{ comment.user.username }}:</strong> {{ comment.text }}</p>
        </div>
        {% endfor %}

        <div class="new-comment">
          <input type="text" class="comment-input" placeholder="Write a comment..." />
          <button class="comment-submit-btn">Post</button>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <footer class="footer">
    <p>&copy; 2024 Andrii Bakai & Alexandr Tanasiychuk. All rights reserved.</p>
  </footer>

  <script src="{% static 'js/inst.js' %}"></script>
</body>
</html>
